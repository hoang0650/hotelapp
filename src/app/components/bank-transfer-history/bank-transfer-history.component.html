<div class="bank-transfer-history-container">
  <p>Lịch sử giao dịch SePay</p>

  <nz-alert *ngIf="errorMessage" nzType="error" [nzMessage]="errorMessage" nzShowIcon class="error-alert"></nz-alert>

  <div *ngIf="isLoading" class="loading-spinner">
    <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
    <p>Đang tải dữ liệu...</p>
  </div>

  <div *ngIf="!isLoading && !errorMessage">
    <nz-table 
      #sepayTable 
      [nzData]="transactions" 
      [nzLoading]="isLoading"
      [nzPageSize]="pageSize"
      [nzPageIndex]="pageIndex"
      [nzTotal]="totalTransactions" 
      (nzPageIndexChange)="onPageIndexChange($event)"
      (nzPageSizeChange)="onPageSizeChange($event)"
      nzShowSizeChanger
      nzShowQuickJumper
      [nzFrontPagination]="false" 
      nzBordered
      nzSize="middle"
    >
      <thead>
        <tr>
          <th 
            *ngFor="let column of listOfColumns" 
            [nzSortOrder]="column.sortOrder"
            [nzSortFn]="column.sortFn"
            [nzSortDirections]="column.sortDirections"
            [nzFilterMultiple]="column.filterMultiple"
            [nzFilters]="column.listOfFilter || []"
            [nzFilterFn]="column.filterFn || true"
          >
            {{ column.name }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of sepayTable.data">
          <td>{{ data.id }}</td>
          <td>{{ data.bank_brand_name }}</td>
          <td>{{ data.account_number }}</td>
          <td>{{ data.transaction_date | date:'dd/MM/yyyy HH:mm:ss' }}</td>
          <td class="amount-out">{{ data.amount_out | number:'1.0-0' }} VND</td>
          <td class="amount-in">{{ data.amount_in | number:'1.0-0' }} VND</td>
          <td>{{ data.transaction_content }}</td>
          <td>{{ data.reference_number }}</td>
        </tr>
      </tbody>
    </nz-table>
    <div *ngIf="!isLoading && transactions.length === 0 && !errorMessage" class="no-data-message">
      <nz-empty nzNotFoundContent="Không có dữ liệu giao dịch cho khoảng thời gian đã chọn."></nz-empty>
    </div>
  </div>
</div> 